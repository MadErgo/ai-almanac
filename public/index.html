<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIé»„å† / The Dao Almanac - Your Daily Cosmic Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            padding: 20px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 24px;
            font-weight: bold;
        }

        .logo-icon {
            font-size: 32px;
        }

        .title {
            display: flex;
            flex-direction: column;
        }

        .title-main {
            font-size: 24px;
            background: linear-gradient(90deg, #ffd700, #ffed4e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .title-sub {
            font-size: 12px;
            color: #999;
        }

        .controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .lang-btn {
            padding: 8px 16px;
            background: transparent;
            border: 1px solid #ffd700;
            color: #ffd700;
            cursor: pointer;
            border-radius: 20px;
            transition: all 0.3s;
            font-size: 14px;
        }

        .lang-btn.active {
            background: #ffd700;
            color: #1a1a2e;
        }

        .lang-btn:hover {
            background: #ffd700;
            color: #1a1a2e;
        }

        .status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4ade80;
        }

        .status-dot.disconnected {
            background: #ef4444;
        }

        main {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-top: 40px;
        }

        .form-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 40px;
        }

        .form-title {
            font-size: 24px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 500;
            color: #e0e0e0;
        }

        .required {
            color: #ffd700;
        }

        input[type="text"],
        input[type="date"],
        select {
            width: 100%;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #e0e0e0;
            font-size: 14px;
            transition: all 0.3s;
        }

        input[type="text"]::placeholder,
        select {
            color: #888;
        }

        input[type="text"]:focus,
        input[type="date"]:focus,
        select:focus {
            outline: none;
            border-color: #ffd700;
            background: rgba(255, 255, 255, 0.12);
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.2);
        }

        .radio-group {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        input[type="radio"] {
            cursor: pointer;
            accent-color: #ffd700;
        }

        .hint {
            font-size: 12px;
            color: #888;
            margin-top: 6px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .hint-icon {
            font-size: 14px;
        }

        .privacy-notice {
            background: rgba(59, 130, 246, 0.1);
            border-left: 3px solid #3b82f6;
            padding: 12px 16px;
            border-radius: 4px;
            font-size: 12px;
            color: #a0aec0;
            margin-top: 20px;
            line-height: 1.5;
        }

        .buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        button {
            flex: 1;
            padding: 14px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-generate {
            background: #ffd700;
            color: #1a1a2e;
        }

        .btn-generate:hover {
            background: #ffed4e;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 215, 0, 0.3);
        }

        .btn-generate:disabled {
            background: #888;
            cursor: not-allowed;
            transform: none;
        }

        .btn-share {
            background: rgba(255, 255, 255, 0.1);
            color: #ffd700;
            border: 1px solid #ffd700;
        }

        .btn-share:hover {
            background: rgba(255, 215, 0, 0.1);
            transform: translateY(-2px);
        }

        .result-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 40px;
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .result-title {
            font-size: 28px;
            font-weight: bold;
            text-align: center;
        }

        .date-display {
            text-align: center;
            font-size: 16px;
            color: #888;
        }

        .element-display {
            display: flex;
            justify-content: center;
            gap: 20px;
            font-size: 14px;
        }

        .element-item {
            padding: 8px 16px;
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid #ffd700;
            border-radius: 20px;
            color: #ffd700;
        }

        .result-item {
            padding: 20px;
            background: rgba(255, 255, 255, 0.03);
            border-left: 3px solid #ffd700;
            border-radius: 4px;
        }

        .result-label {
            font-size: 12px;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }

        .result-content {
            font-size: 16px;
            line-height: 1.6;
            color: #e0e0e0;
            min-height: 40px;
        }

        .wisdom {
            font-size: 18px;
            text-align: center;
            padding: 24px;
            background: rgba(255, 215, 0, 0.08);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 8px;
            font-style: italic;
            line-height: 1.8;
            color: #ffd700;
        }

        .footer-name {
            text-align: right;
            font-size: 14px;
            color: #888;
            margin-top: 20px;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 215, 0, 0.3);
            border-top-color: #ffd700;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .message {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 24px;
            background: #2d3748;
            color: #e0e0e0;
            border-radius: 8px;
            display: none;
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
        }

        .message.show {
            display: block;
        }

        .message.success {
            background: #10b981;
            color: white;
        }

        .message.error {
            background: #ef4444;
            color: white;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @media (max-width: 1024px) {
            main {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 20px;
            }

            .form-section,
            .result-section {
                padding: 24px;
            }

            .title-main {
                font-size: 18px;
            }

            .controls {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <span class="logo-icon">ğŸ”®</span>
                <div class="title">
                    <div class="title-main">AIé»„å† / The Dao Almanac</div>
                    <div class="title-sub">MVP Â· Your Daily Cosmic Guide</div>
                </div>
            </div>
            <div class="controls">
                <button class="lang-btn active" id="btn-cn" onclick="switchLanguage('cn')">ä¸­æ–‡</button>
                <button class="lang-btn" id="btn-en" onclick="switchLanguage('en')">English</button>
                <div class="status">
                    <span id="apiStatus" class="status-dot"></span>
                    <span id="apiStatusText">X APIè¿æ¥</span>
                </div>
            </div>
        </header>

        <main>
            <div class="form-section">
                <h2 class="form-title" id="form-title">ç”Ÿæˆä½ çš„é»„å†ç­¾æ–‡</h2>
                
                <form id="almanacForm">
                    <div class="form-group">
                        <label for="name" id="label-name">å§“å <span class="required">*</span></label>
                        <input type="text" id="name" placeholder="è¯·è¾“å…¥æ‚¨çš„åå­—" required>
                        <div class="hint" id="hint-name">
                            <span class="hint-icon">â„¹ï¸</span>
                            <span id="hint-name-text">ä»…ç”¨äºAIåˆ†æï¼Œä¸ä¼šå…¬å¼€</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="nickname" id="label-nickname">æ˜µç§° <span class="required">*</span></label>
                        <input type="text" id="nickname" placeholder="è¯·è¾“å…¥æ˜µç§°" required>
                        <div class="hint" id="hint-nickname">
                            <span class="hint-icon">âœ¨</span>
                            <span id="hint-nickname-text">å°†æ˜¾ç¤ºåœ¨æ‚¨çš„ç­¾æ–‡ä¸­</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="birthdate" id="label-birthdate">ç”Ÿæ—¥ <span class="required">*</span></label>
                        <input type="date" id="birthdate" required>
                    </div>

                    <div class="form-group">
                        <label for="birthTime" id="label-birthTime">å‡ºç”Ÿæ—¶åˆ» (å¯é€‰)</label>
                        <select id="birthTime">
                            <option value="unknown" id="time-unknown">ä¸ç¡®å®š</option>
                            <option value="dawn" id="time-dawn">æ¸…æ™¨ (05:00-07:00)</option>
                            <option value="morning" id="time-morning">ä¸Šåˆ (07:00-11:00)</option>
                            <option value="noon" id="time-noon">ä¸­åˆ (11:00-13:00)</option>
                            <option value="afternoon" id="time-afternoon">ä¸‹åˆ (13:00-17:00)</option>
                            <option value="dusk" id="time-dusk">å‚æ™š (17:00-19:00)</option>
                            <option value="night" id="time-night">å¤œé—´ (19:00-05:00)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label id="label-mood">å¿ƒæƒ…çŠ¶æ€ <span class="required">*</span></label>
                        <div class="radio-group">
                            <label class="radio-item">
                                <input type="radio" name="mood" value="calm" checked>
                                <span id="mood-calm">å¹³é™</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="mood" value="anxious">
                                <span id="mood-anxious">ç„¦è™‘</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="mood" value="impulsive">
                                <span id="mood-impulsive">å†²åŠ¨</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="mood" value="focused">
                                <span id="mood-focused">ä¸“æ³¨</span>
                            </label>
                        </div>
                    </div>

                    <div class="privacy-notice" id="privacy-notice">
                        ğŸ”’ éšç§æç¤ºï¼šæ‚¨çš„å§“åå’Œç”Ÿæ—¥ä»…ç”¨äºAIå‘½ç†åˆ†æï¼Œç»ä¸ä¼šæ˜¾ç¤ºåœ¨åˆ†äº«å¡ç‰‡ä¸­ï¼Œç­¾æ–‡åªä¼šä»¥"æ˜µç§°"çš„å½¢å¼æ˜¾ç¤ºã€‚
                    </div>

                    <div class="buttons">
                        <button type="submit" class="btn-generate" id="btn-generate">ç”Ÿæˆç­¾æ–‡</button>
                        <button type="button" class="btn-share" id="btn-share" style="display: none;">åˆ†äº«å¡ç‰‡</button>
                    </div>
                </form>
            </div>

            <div class="result-section">
                <div class="result-title" id="result-title">ä»Šæ—¥é»„å†</div>
                <div class="date-display" id="date">2025å¹´10æœˆ30æ—¥</div>
                <div class="element-display">
                    <div class="element-item" id="element">äº”è¡Œ</div>
                    <div class="element-item" id="polarity">é˜´é˜³</div>
                </div>

                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <div id="loading-text">æ­£åœ¨ç”Ÿæˆæ‚¨çš„ç­¾æ–‡...</div>
                </div>

                <div id="resultContent" style="display: none;">
                    <div class="result-item">
                        <div class="result-label" id="label-auspicious">å®œ</div>
                        <div class="result-content" id="auspicious"></div>
                    </div>

                    <div class="result-item">
                        <div class="result-label" id="label-avoid">å¿Œ</div>
                        <div class="result-content" id="avoid"></div>
                    </div>

                    <div class="result-item">
                        <div class="result-label" id="label-lucky">å¹¸è¿æç¤º</div>
                        <div class="result-content" id="lucky"></div>
                    </div>

                    <div class="wisdom" id="wisdom"></div>

                    <div class="footer-name" id="footer"></div>
                </div>
            </div>
        </main>
    </div>

    <div class="message" id="message"></div>

    <script>
        // é…ç½®
        const API_BASE_URL = 'https://ai-almanac.vercel.app';

        let currentLanguage = 'cn';
        let apiConnected = false;

        // å¤šè¯­è¨€é…ç½®
        const translations = {
            cn: {
                'form-title': 'ç”Ÿæˆä½ çš„é»„å†ç­¾æ–‡',
                'label-name': 'å§“å',
                'label-nickname': 'æ˜µç§°',
                'label-birthdate': 'ç”Ÿæ—¥',
                'label-birthTime': 'å‡ºç”Ÿæ—¶åˆ» (å¯é€‰)',
                'label-mood': 'å¿ƒæƒ…çŠ¶æ€',
                'mood-calm': 'å¹³é™',
                'mood-anxious': 'ç„¦è™‘',
                'mood-impulsive': 'å†²åŠ¨',
                'mood-focused': 'ä¸“æ³¨',
                'time-dawn': 'æ¸…æ™¨ (05:00-07:00)',
                'time-morning': 'ä¸Šåˆ (07:00-11:00)',
                'time-noon': 'ä¸­åˆ (11:00-13:00)',
                'time-afternoon': 'ä¸‹åˆ (13:00-17:00)',
                'time-dusk': 'å‚æ™š (17:00-19:00)',
                'time-night': 'å¤œé—´ (19:00-05:00)',
                'time-unknown': 'ä¸ç¡®å®š',
                'hint-name': 'ä»…ç”¨äºAIåˆ†æï¼Œä¸ä¼šå…¬å¼€',
                'hint-nickname': 'å°†æ˜¾ç¤ºåœ¨æ‚¨çš„ç­¾æ–‡ä¸­',
                'privacy-notice': 'ğŸ”’ éšç§æç¤ºï¼šæ‚¨çš„å§“åå’Œç”Ÿæ—¥ä»…ç”¨äºAIå‘½ç†åˆ†æï¼Œç»ä¸ä¼šæ˜¾ç¤ºåœ¨åˆ†äº«å¡ç‰‡ä¸­ï¼Œç­¾æ–‡åªä¼šä»¥"æ˜µç§°"çš„å½¢å¼æ˜¾ç¤ºã€‚',
                'btn-generate': 'ç”Ÿæˆç­¾æ–‡',
                'btn-share': 'åˆ†äº«å¡ç‰‡',
                'result-title': 'ä»Šæ—¥é»„å†',
                'label-auspicious': 'å®œ',
                'label-avoid': 'å¿Œ',
                'label-lucky': 'å¹¸è¿æç¤º',
                'loading-text': 'æ­£åœ¨ç”Ÿæˆæ‚¨çš„ç­¾æ–‡...',
                'success-generate': 'âœ“ ç­¾æ–‡å·²ç”Ÿæˆ',
                'error-required': 'è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µ',
                'error-network': 'ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥APIæœåŠ¡å™¨',
                'statusKey': 'statusText'
            },
            en: {
                'form-title': 'Generate Your Almanac Reading',
                'label-name': 'Name',
                'label-nickname': 'Nickname',
                'label-birthdate': 'Birth Date',
                'label-birthTime': 'Birth Time (Optional)',
                'label-mood': 'Current Mood',
                'mood-calm': 'Calm',
                'mood-anxious': 'Anxious',
                'mood-impulsive': 'Impulsive',
                'mood-focused': 'Focused',
                'time-dawn': 'Dawn (05:00-07:00)',
                'time-morning': 'Morning (07:00-11:00)',
                'time-noon': 'Noon (11:00-13:00)',
                'time-afternoon': 'Afternoon (13:00-17:00)',
                'time-dusk': 'Dusk (17:00-19:00)',
                'time-night': 'Night (19:00-05:00)',
                'time-unknown': 'Unknown',
                'hint-name': 'For AI analysis only, never shared',
                'hint-nickname': 'Will be displayed in your reading',
                'privacy-notice': 'ğŸ”’ Privacy Notice: Your name and birth date are used only for AI divination analysis and will never be shown on shared cards. Only your nickname will be displayed.',
                'btn-generate': 'Generate Reading',
                'btn-share': 'Share Card',
                'result-title': 'Today\'s Almanac',
                'label-auspicious': 'Auspicious',
                'label-avoid': 'Avoid',
                'label-lucky': 'Lucky Tips',
                'loading-text': 'Generating your reading...',
                'success-generate': 'âœ“ Reading generated',
                'error-required': 'Please fill in all required fields',
                'error-network': 'Network error. Please check the API server',
                'statusKey': 'statusText'
            }
        };

        // æ£€æŸ¥APIè¿æ¥
        async function checkApiStatus() {
            try {
                const response = await fetch(`${API_BASE_URL}/api/health`, { timeout: 5000 });
                apiConnected = response.ok;
            } catch (error) {
                apiConnected = false;
            }
            updateApiStatus();
        }

        function updateApiStatus() {
            const status = document.getElementById('apiStatus');
            const statusText = document.getElementById('apiStatusText');
            if (apiConnected) {
                status.classList.remove('disconnected');
                statusText.textContent = currentLanguage === 'cn' ? 'âœ“ APIå·²è¿æ¥' : 'âœ“ API Connected';
            } else {
                status.classList.add('disconnected');
                statusText.textContent = currentLanguage === 'cn' ? 'X APIè¿æ¥' : 'X API Disconnected';
            }
        }

        // åˆ‡æ¢è¯­è¨€
        function switchLanguage(lang) {
            currentLanguage = lang;
            document.getElementById('btn-cn').classList.toggle('active', lang === 'cn');
            document.getElementById('btn-en').classList.toggle('active', lang === 'en');
            updateTexts();
            updateApiStatus();
        }

        function updateTexts() {
            const trans = translations[currentLanguage];
            document.getElementById('form-title').textContent = trans['form-title'];
            document.getElementById('label-name').innerHTML = trans['label-name'] + ' <span class="required">*</span>';
            document.getElementById('label-nickname').innerHTML = trans['label-nickname'] + ' <span class="required">*</span>';
            document.getElementById('label-birthdate').innerHTML = trans['label-birthdate'] + ' <span class="required">*</span>';
            document.getElementById('label-birthTime').textContent = trans['label-birthTime'];
            document.getElementById('label-mood').innerHTML = trans['label-mood'] + ' <span class="required">*</span>';
            
            document.getElementById('mood-calm').textContent = trans['mood-calm'];
            document.getElementById('mood-anxious').textContent = trans['mood-anxious'];
            document.getElementById('mood-impulsive').textContent = trans['mood-impulsive'];
            document.getElementById('mood-focused').textContent = trans['mood-focused'];
            
            document.getElementById('time-dawn').textContent = trans['time-dawn'];
            document.getElementById('time-morning').textContent = trans['time-morning'];
            document.getElementById('time-noon').textContent = trans['time-noon'];
            document.getElementById('time-afternoon').textContent = trans['time-afternoon'];
            document.getElementById('time-dusk').textContent = trans['time-dusk'];
            document.getElementById('time-night').textContent = trans['time-night'];
            document.getElementById('time-unknown').textContent = trans['time-unknown'];
            
            document.getElementById('hint-name-text').textContent = trans['hint-name'];
            document.getElementById('hint-nickname-text').textContent = trans['hint-nickname'];
            document.getElementById('privacy-notice').textContent = trans['privacy-notice'];
            document.getElementById('btn-generate').textContent = trans['btn-generate'];
            document.getElementById('result-title').textContent = trans['result-title'];
            document.getElementById('label-auspicious').textContent = trans['label-auspicious'];
            document.getElementById('label-avoid').textContent = trans['label-avoid'];
            document.getElementById('label-lucky').textContent = trans['label-lucky'];
            document.getElementById('loading-text').textContent = trans['loading-text'];
        }

        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
            document.getElementById('resultContent').style.display = show ? 'none' : 'block';
            document.getElementById('btn-generate').disabled = show;
        }

        // æ˜¾ç¤ºæ¶ˆæ¯
        function showMessage(type, text) {
            const msg = document.getElementById('message');
            msg.textContent = text;
            msg.className = `message show ${type}`;
            setTimeout(() => {
                msg.classList.remove('show');
            }, 3000);
        }

        // æ˜¾ç¤ºç»“æœ
        function displayResult(data, nickname) {
            const today = new Date();
            const dateStr = currentLanguage === 'cn'
                ? `${today.getFullYear()}å¹´${today.getMonth() + 1}æœˆ${today.getDate()}æ—¥`
                : `${today.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}`;

            // å¤„ç†æ•°æ®ä¸­çš„å„ä¸ªå­—æ®µ
            const auspicious = data.auspicious || '';
            const avoid = data.avoid || '';
            const lucky = data.lucky || `${data.luckyDirection || ''} Â· ${data.luckyColor || ''} Â· ${data.luckyHour || ''}`;
            const wisdom = data.wisdom || '';

            document.getElementById('date').textContent = dateStr;
            document.getElementById('auspicious').textContent = auspicious;
            document.getElementById('avoid').textContent = avoid;
            document.getElementById('lucky').textContent = lucky;
            document.getElementById('wisdom').textContent = wisdom;
            document.getElementById('footer').textContent = `â€” For ${nickname}`;

            showLoading(false);
        }

        // è¡¨å•æäº¤
        document.getElementById('almanacForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const formData = {
                name: document.getElementById('name').value,
                nickname: document.getElementById('nickname').value,
                birthdate: document.getElementById('birthdate').value,
                birthTime: document.getElementById('birthTime').value,
                mood: document.querySelector('input[name="mood"]:checked').value,
                language: currentLanguage
            };

            if (!formData.name || !formData.nickname || !formData.birthdate) {
                showMessage('error', translations[currentLanguage]['error-required']);
                return;
            }

            showLoading(true);

            try {
                const response = await fetch(`${API_BASE_URL}/api/generate-almanac`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                if (!response.ok) {
                    throw new Error('API request failed');
                }

                const result = await response.json();
                
                // å¤„ç†åç«¯è¿”å›çš„æ•°æ®æ ¼å¼
                let almanacData;
                if (result.data && typeof result.data === 'object') {
                    almanacData = result.data;
                } else if (result.success && result.data) {
                    almanacData = result.data;
                } else {
                    almanacData = result;
                }
                
                displayResult(almanacData, formData.nickname);
                showMessage('success', translations[currentLanguage]['success-generate']);
            } catch (error) {
                console.error('Error:', error);
                showMessage('error', translations[currentLanguage]['error-network']);
                showLoading(false);
            }
        });

        // åˆå§‹åŒ–
        window.addEventListener('load', () => {
            checkApiStatus();
            updateTexts();
            setInterval(checkApiStatus, 30000); // æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡APIçŠ¶æ€
        });
    </script>
</body>
</html>
EOF
cat /mnt/user-data/outputs/index.html
Output

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIé»„å† / The Dao Almanac - Your Daily Cosmic Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            padding: 20px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 24px;
            font-weight: bold;
        }

        .logo-icon {
            font-size: 32px;
        }

        .title {
            display: flex;
            flex-direction: column;
        }

        .title-main {
            font-size: 24px;
            background: linear-gradient(90deg, #ffd700, #ffed4e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .title-sub {
            font-size: 12px;
            color: #999;
        }

        .controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .lang-btn {
            padding: 8px 16px;
            background: transparent;
            border: 1px solid #ffd700;
            color: #ffd700;
            cursor: pointer;
            border-radius: 20px;
            transition: all 0.3s;
            font-size: 14px;
        }

        .lang-btn.active {
            background: #ffd700;
            color: #1a1a2e;
        }

        .lang-btn:hover {
            background: #ffd700;
            color: #1a1a2e;
        }

        .status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4ade80;
        }

        .status-dot.disconnected {
            background: #ef4444;
        }

        main {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-top: 40px;
        }

        .form-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 40px;
        }

        .form-title {
            font-size: 24px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 500;
            color: #e0e0e0;
        }

        .required {
            color: #ffd700;
        }

        input[type="text"],
        input[type="date"],
        select {
            width: 100%;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #e0e0e0;
            font-size: 14px;
            transition: all 0.3s;
        }

        input[type="text"]::placeholder,
        select {
            color: #888;
        }

        input[type="text"]:focus,
        input[type="date"]:focus,
        select:focus {
            outline: none;
            border-color: #ffd700;
            background: rgba(255, 255, 255, 0.12);
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.2);
        }

        .radio-group {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        input[type="radio"] {
            cursor: pointer;
            accent-color: #ffd700;
        }

        .hint {
            font-size: 12px;
            color: #888;
            margin-top: 6px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .hint-icon {
            font-size: 14px;
        }

        .privacy-notice {
            background: rgba(59, 130, 246, 0.1);
            border-left: 3px solid #3b82f6;
            padding: 12px 16px;
            border-radius: 4px;
            font-size: 12px;
            color: #a0aec0;
            margin-top: 20px;
            line-height: 1.5;
        }

        .buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        button {
            flex: 1;
            padding: 14px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-generate {
            background: #ffd700;
            color: #1a1a2e;
        }

        .btn-generate:hover {
            background: #ffed4e;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 215, 0, 0.3);
        }

        .btn-generate:disabled {
            background: #888;
            cursor: not-allowed;
            transform: none;
        }

        .btn-share {
            background: rgba(255, 255, 255, 0.1);
            color: #ffd700;
            border: 1px solid #ffd700;
        }

        .btn-share:hover {
            background: rgba(255, 215, 0, 0.1);
            transform: translateY(-2px);
        }

        .result-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 40px;
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .result-title {
            font-size: 28px;
            font-weight: bold;
            text-align: center;
        }

        .date-display {
            text-align: center;
            font-size: 16px;
            color: #888;
        }

        .element-display {
            display: flex;
            justify-content: center;
            gap: 20px;
            font-size: 14px;
        }

        .element-item {
            padding: 8px 16px;
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid #ffd700;
            border-radius: 20px;
            color: #ffd700;
        }

        .result-item {
            padding: 20px;
            background: rgba(255, 255, 255, 0.03);
            border-left: 3px solid #ffd700;
            border-radius: 4px;
        }

        .result-label {
            font-size: 12px;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }

        .result-content {
            font-size: 16px;
            line-height: 1.6;
            color: #e0e0e0;
            min-height: 40px;
        }

        .wisdom {
            font-size: 18px;
            text-align: center;
            padding: 24px;
            background: rgba(255, 215, 0, 0.08);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 8px;
            font-style: italic;
            line-height: 1.8;
            color: #ffd700;
        }

        .footer-name {
            text-align: right;
            font-size: 14px;
            color: #888;
            margin-top: 20px;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 215, 0, 0.3);
            border-top-color: #ffd700;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .message {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 24px;
            background: #2d3748;
            color: #e0e0e0;
            border-radius: 8px;
            display: none;
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
        }

        .message.show {
            display: block;
        }

        .message.success {
            background: #10b981;
            color: white;
        }

        .message.error {
            background: #ef4444;
            color: white;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @media (max-width: 1024px) {
            main {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 20px;
            }

            .form-section,
            .result-section {
                padding: 24px;
            }

            .title-main {
                font-size: 18px;
            }

            .controls {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <span class="logo-icon">ğŸ”®</span>
                <div class="title">
                    <div class="title-main">AIé»„å† / The Dao Almanac</div>
                    <div class="title-sub">MVP Â· Your Daily Cosmic Guide</div>
                </div>
            </div>
            <div class="controls">
                <button class="lang-btn active" id="btn-cn" onclick="switchLanguage('cn')">ä¸­æ–‡</button>
                <button class="lang-btn" id="btn-en" onclick="switchLanguage('en')">English</button>
                <div class="status">
                    <span id="apiStatus" class="status-dot"></span>
                    <span id="apiStatusText">X APIè¿æ¥</span>
                </div>
            </div>
        </header>

        <main>
            <div class="form-section">
                <h2 class="form-title" id="form-title">ç”Ÿæˆä½ çš„é»„å†ç­¾æ–‡</h2>
                
                <form id="almanacForm">
                    <div class="form-group">
                        <label for="name" id="label-name">å§“å <span class="required">*</span></label>
                        <input type="text" id="name" placeholder="è¯·è¾“å…¥æ‚¨çš„åå­—" required>
                        <div class="hint" id="hint-name">
                            <span class="hint-icon">â„¹ï¸</span>
                            <span id="hint-name-text">ä»…ç”¨äºAIåˆ†æï¼Œä¸ä¼šå…¬å¼€</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="nickname" id="label-nickname">æ˜µç§° <span class="required">*</span></label>
                        <input type="text" id="nickname" placeholder="è¯·è¾“å…¥æ˜µç§°" required>
                        <div class="hint" id="hint-nickname">
                            <span class="hint-icon">âœ¨</span>
                            <span id="hint-nickname-text">å°†æ˜¾ç¤ºåœ¨æ‚¨çš„ç­¾æ–‡ä¸­</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="birthdate" id="label-birthdate">ç”Ÿæ—¥ <span class="required">*</span></label>
                        <input type="date" id="birthdate" required>
                    </div>

                    <div class="form-group">
                        <label for="birthTime" id="label-birthTime">å‡ºç”Ÿæ—¶åˆ» (å¯é€‰)</label>
                        <select id="birthTime">
                            <option value="unknown" id="time-unknown">ä¸ç¡®å®š</option>
                            <option value="dawn" id="time-dawn">æ¸…æ™¨ (05:00-07:00)</option>
                            <option value="morning" id="time-morning">ä¸Šåˆ (07:00-11:00)</option>
                            <option value="noon" id="time-noon">ä¸­åˆ (11:00-13:00)</option>
                            <option value="afternoon" id="time-afternoon">ä¸‹åˆ (13:00-17:00)</option>
                            <option value="dusk" id="time-dusk">å‚æ™š (17:00-19:00)</option>
                            <option value="night" id="time-night">å¤œé—´ (19:00-05:00)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label id="label-mood">å¿ƒæƒ…çŠ¶æ€ <span class="required">*</span></label>
                        <div class="radio-group">
                            <label class="radio-item">
                                <input type="radio" name="mood" value="calm" checked>
                                <span id="mood-calm">å¹³é™</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="mood" value="anxious">
                                <span id="mood-anxious">ç„¦è™‘</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="mood" value="impulsive">
                                <span id="mood-impulsive">å†²åŠ¨</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="mood" value="focused">
                                <span id="mood-focused">ä¸“æ³¨</span>
                            </label>
                        </div>
                    </div>

                    <div class="privacy-notice" id="privacy-notice">
                        ğŸ”’ éšç§æç¤ºï¼šæ‚¨çš„å§“åå’Œç”Ÿæ—¥ä»…ç”¨äºAIå‘½ç†åˆ†æï¼Œç»ä¸ä¼šæ˜¾ç¤ºåœ¨åˆ†äº«å¡ç‰‡ä¸­ï¼Œç­¾æ–‡åªä¼šä»¥"æ˜µç§°"çš„å½¢å¼æ˜¾ç¤ºã€‚
                    </div>

                    <div class="buttons">
                        <button type="submit" class="btn-generate" id="btn-generate">ç”Ÿæˆç­¾æ–‡</button>
                        <button type="button" class="btn-share" id="btn-share" style="display: none;">åˆ†äº«å¡ç‰‡</button>
                    </div>
                </form>
            </div>

            <div class="result-section">
                <div class="result-title" id="result-title">ä»Šæ—¥é»„å†</div>
                <div class="date-display" id="date">2025å¹´10æœˆ30æ—¥</div>
                <div class="element-display">
                    <div class="element-item" id="element">äº”è¡Œ</div>
                    <div class="element-item" id="polarity">é˜´é˜³</div>
                </div>

                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <div id="loading-text">æ­£åœ¨ç”Ÿæˆæ‚¨çš„ç­¾æ–‡...</div>
                </div>

                <div id="resultContent" style="display: none;">
                    <div class="result-item">
                        <div class="result-label" id="label-auspicious">å®œ</div>
                        <div class="result-content" id="auspicious"></div>
                    </div>

                    <div class="result-item">
                        <div class="result-label" id="label-avoid">å¿Œ</div>
                        <div class="result-content" id="avoid"></div>
                    </div>

                    <div class="result-item">
                        <div class="result-label" id="label-lucky">å¹¸è¿æç¤º</div>
                        <div class="result-content" id="lucky"></div>
                    </div>

                    <div class="wisdom" id="wisdom"></div>

                    <div class="footer-name" id="footer"></div>
                </div>
            </div>
        </main>
    </div>

    <div class="message" id="message"></div>

    <script>
        // é…ç½®
        const API_BASE_URL = 'https://ai-almanac.vercel.app';

        let currentLanguage = 'cn';
        let apiConnected = false;

        // å¤šè¯­è¨€é…ç½®
        const translations = {
            cn: {
                'form-title': 'ç”Ÿæˆä½ çš„é»„å†ç­¾æ–‡',
                'label-name': 'å§“å',
                'label-nickname': 'æ˜µç§°',
                'label-birthdate': 'ç”Ÿæ—¥',
                'label-birthTime': 'å‡ºç”Ÿæ—¶åˆ» (å¯é€‰)',
                'label-mood': 'å¿ƒæƒ…çŠ¶æ€',
                'mood-calm': 'å¹³é™',
                'mood-anxious': 'ç„¦è™‘',
                'mood-impulsive': 'å†²åŠ¨',
                'mood-focused': 'ä¸“æ³¨',
                'time-dawn': 'æ¸…æ™¨ (05:00-07:00)',
                'time-morning': 'ä¸Šåˆ (07:00-11:00)',
                'time-noon': 'ä¸­åˆ (11:00-13:00)',
                'time-afternoon': 'ä¸‹åˆ (13:00-17:00)',
                'time-dusk': 'å‚æ™š (17:00-19:00)',
                'time-night': 'å¤œé—´ (19:00-05:00)',
                'time-unknown': 'ä¸ç¡®å®š',
                'hint-name': 'ä»…ç”¨äºAIåˆ†æï¼Œä¸ä¼šå…¬å¼€',
                'hint-nickname': 'å°†æ˜¾ç¤ºåœ¨æ‚¨çš„ç­¾æ–‡ä¸­',
                'privacy-notice': 'ğŸ”’ éšç§æç¤ºï¼šæ‚¨çš„å§“åå’Œç”Ÿæ—¥ä»…ç”¨äºAIå‘½ç†åˆ†æï¼Œç»ä¸ä¼šæ˜¾ç¤ºåœ¨åˆ†äº«å¡ç‰‡ä¸­ï¼Œç­¾æ–‡åªä¼šä»¥"æ˜µç§°"çš„å½¢å¼æ˜¾ç¤ºã€‚',
                'btn-generate': 'ç”Ÿæˆç­¾æ–‡',
                'btn-share': 'åˆ†äº«å¡ç‰‡',
                'result-title': 'ä»Šæ—¥é»„å†',
                'label-auspicious': 'å®œ',
                'label-avoid': 'å¿Œ',
                'label-lucky': 'å¹¸è¿æç¤º',
                'loading-text': 'æ­£åœ¨ç”Ÿæˆæ‚¨çš„ç­¾æ–‡...',
                'success-generate': 'âœ“ ç­¾æ–‡å·²ç”Ÿæˆ',
                'error-required': 'è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µ',
                'error-network': 'ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥APIæœåŠ¡å™¨',
                'statusKey': 'statusText'
            },
            en: {
                'form-title': 'Generate Your Almanac Reading',
                'label-name': 'Name',
                'label-nickname': 'Nickname',
                'label-birthdate': 'Birth Date',
                'label-birthTime': 'Birth Time (Optional)',
                'label-mood': 'Current Mood',
                'mood-calm': 'Calm',
                'mood-anxious': 'Anxious',
                'mood-impulsive': 'Impulsive',
                'mood-focused': 'Focused',
                'time-dawn': 'Dawn (05:00-07:00)',
                'time-morning': 'Morning (07:00-11:00)',
                'time-noon': 'Noon (11:00-13:00)',
                'time-afternoon': 'Afternoon (13:00-17:00)',
                'time-dusk': 'Dusk (17:00-19:00)',
                'time-night': 'Night (19:00-05:00)',
                'time-unknown': 'Unknown',
                'hint-name': 'For AI analysis only, never shared',
                'hint-nickname': 'Will be displayed in your reading',
                'privacy-notice': 'ğŸ”’ Privacy Notice: Your name and birth date are used only for AI divination analysis and will never be shown on shared cards. Only your nickname will be displayed.',
                'btn-generate': 'Generate Reading',
                'btn-share': 'Share Card',
                'result-title': 'Today\'s Almanac',
                'label-auspicious': 'Auspicious',
                'label-avoid': 'Avoid',
                'label-lucky': 'Lucky Tips',
                'loading-text': 'Generating your reading...',
                'success-generate': 'âœ“ Reading generated',
                'error-required': 'Please fill in all required fields',
                'error-network': 'Network error. Please check the API server',
                'statusKey': 'statusText'
            }
        };

        // æ£€æŸ¥APIè¿æ¥
        async function checkApiStatus() {
            try {
                const response = await fetch(`${API_BASE_URL}/api/health`, { timeout: 5000 });
                apiConnected = response.ok;
            } catch (error) {
                apiConnected = false;
            }
            updateApiStatus();
        }

        function updateApiStatus() {
            const status = document.getElementById('apiStatus');
            const statusText = document.getElementById('apiStatusText');
            if (apiConnected) {
                status.classList.remove('disconnected');
                statusText.textContent = currentLanguage === 'cn' ? 'âœ“ APIå·²è¿æ¥' : 'âœ“ API Connected';
            } else {
                status.classList.add('disconnected');
                statusText.textContent = currentLanguage === 'cn' ? 'X APIè¿æ¥' : 'X API Disconnected';
            }
        }

        // åˆ‡æ¢è¯­è¨€
        function switchLanguage(lang) {
            currentLanguage = lang;
            document.getElementById('btn-cn').classList.toggle('active', lang === 'cn');
            document.getElementById('btn-en').classList.toggle('active', lang === 'en');
            updateTexts();
            updateApiStatus();
        }

        function updateTexts() {
            const trans = translations[currentLanguage];
            document.getElementById('form-title').textContent = trans['form-title'];
            document.getElementById('label-name').innerHTML = trans['label-name'] + ' <span class="required">*</span>';
            document.getElementById('label-nickname').innerHTML = trans['label-nickname'] + ' <span class="required">*</span>';
            document.getElementById('label-birthdate').innerHTML = trans['label-birthdate'] + ' <span class="required">*</span>';
            document.getElementById('label-birthTime').textContent = trans['label-birthTime'];
            document.getElementById('label-mood').innerHTML = trans['label-mood'] + ' <span class="required">*</span>';
            
            document.getElementById('mood-calm').textContent = trans['mood-calm'];
            document.getElementById('mood-anxious').textContent = trans['mood-anxious'];
            document.getElementById('mood-impulsive').textContent = trans['mood-impulsive'];
            document.getElementById('mood-focused').textContent = trans['mood-focused'];
            
            document.getElementById('time-dawn').textContent = trans['time-dawn'];
            document.getElementById('time-morning').textContent = trans['time-morning'];
            document.getElementById('time-noon').textContent = trans['time-noon'];
            document.getElementById('time-afternoon').textContent = trans['time-afternoon'];
            document.getElementById('time-dusk').textContent = trans['time-dusk'];
            document.getElementById('time-night').textContent = trans['time-night'];
            document.getElementById('time-unknown').textContent = trans['time-unknown'];
            
            document.getElementById('hint-name-text').textContent = trans['hint-name'];
            document.getElementById('hint-nickname-text').textContent = trans['hint-nickname'];
            document.getElementById('privacy-notice').textContent = trans['privacy-notice'];
            document.getElementById('btn-generate').textContent = trans['btn-generate'];
            document.getElementById('result-title').textContent = trans['result-title'];
            document.getElementById('label-auspicious').textContent = trans['label-auspicious'];
            document.getElementById('label-avoid').textContent = trans['label-avoid'];
            document.getElementById('label-lucky').textContent = trans['label-lucky'];
            document.getElementById('loading-text').textContent = trans['loading-text'];
        }

        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
            document.getElementById('resultContent').style.display = show ? 'none' : 'block';
            document.getElementById('btn-generate').disabled = show;
        }

        // æ˜¾ç¤ºæ¶ˆæ¯
        function showMessage(type, text) {
            const msg = document.getElementById('message');
            msg.textContent = text;
            msg.className = `message show ${type}`;
            setTimeout(() => {
                msg.classList.remove('show');
            }, 3000);
        }

        // æ˜¾ç¤ºç»“æœ
        function displayResult(data, nickname) {
            const today = new Date();
            const dateStr = currentLanguage === 'cn'
                ? `${today.getFullYear()}å¹´${today.getMonth() + 1}æœˆ${today.getDate()}æ—¥`
                : `${today.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}`;

            // å¤„ç†æ•°æ®ä¸­çš„å„ä¸ªå­—æ®µ
            const auspicious = data.auspicious || '';
            const avoid = data.avoid || '';
            const lucky = data.lucky || `${data.luckyDirection || ''} Â· ${data.luckyColor || ''} Â· ${data.luckyHour || ''}`;
            const wisdom = data.wisdom || '';

            document.getElementById('date').textContent = dateStr;
            document.getElementById('auspicious').textContent = auspicious;
            document.getElementById('avoid').textContent = avoid;
            document.getElementById('lucky').textContent = lucky;
            document.getElementById('wisdom').textContent = wisdom;
            document.getElementById('footer').textContent = `â€” For ${nickname}`;

            showLoading(false);
        }

        // è¡¨å•æäº¤
        document.getElementById('almanacForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const formData = {
                name: document.getElementById('name').value,
                nickname: document.getElementById('nickname').value,
                birthdate: document.getElementById('birthdate').value,
                birthTime: document.getElementById('birthTime').value,
                mood: document.querySelector('input[name="mood"]:checked').value,
                language: currentLanguage
            };

            if (!formData.name || !formData.nickname || !formData.birthdate) {
                showMessage('error', translations[currentLanguage]['error-required']);
                return;
            }

            showLoading(true);

            try {
                const response = await fetch(`${API_BASE_URL}/api/generate-almanac`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                if (!response.ok) {
                    throw new Error('API request failed');
                }

                const result = await response.json();
                
                // å¤„ç†åç«¯è¿”å›çš„æ•°æ®æ ¼å¼
                let almanacData;
                if (result.data && typeof result.data === 'object') {
                    almanacData = result.data;
                } else if (result.success && result.data) {
                    almanacData = result.data;
                } else {
                    almanacData = result;
                }
                
                displayResult(almanacData, formData.nickname);
                showMessage('success', translations[currentLanguage]['success-generate']);
            } catch (error) {
                console.error('Error:', error);
                showMessage('error', translations[currentLanguage]['error-network']);
                showLoading(false);
            }
        });

        // åˆå§‹åŒ–
        window.addEventListener('load', () => {
            checkApiStatus();
            updateTexts();
            setInterval(checkApiStatus, 30000); // æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡APIçŠ¶æ€
        });
    </script>
</body>
</html>
